import javax.swing.*;
import java.awt.BorderLayout;
import java.awt.FlowLayout;
import java.sql.*;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Map;
import java.util.Random;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import java.util.List;

// OOP: Interface
interface Trackable {
    String getGpsId();
    void updateLocation(double lat, double lon);
}

// OOP: Abstract Class
abstract class Vehicle implements Trackable {
    protected String id, regNo;
    protected double fuelEfficiency;
    protected String gpsId;

    public Vehicle(String id, String regNo, double fuelEfficiency) {
        this.id = id;
        this.regNo = regNo;
        this.fuelEfficiency = fuelEfficiency;
    }

    public abstract double estimateCost(Route r);

    public String getGpsId() { return gpsId; }

    public void updateLocation(double lat, double lon) {
        System.out.println(getClass().getSimpleName() + " moved to (" + lat + "," + lon + ")");
    }

    public String toString() {
        return getClass().getSimpleName() + "[" + regNo + "]";
    }
}

// OOP: Inheritance + Polymorphism
class Bus extends Vehicle {
    private int seats;
    public Bus(String id, String regNo, double eff, int seats) {
        super(id, regNo, eff);
        this.seats = seats;
        this.gpsId = "BUS-" + id;
    }
    public double estimateCost(Route r) {
        return (r.distanceKm / fuelEfficiency) * r.fuelPrice + seats * 0.1;
    }
}

class Truck extends Vehicle {
    private double load;
    public Truck(String id, String regNo, double eff, double load) {
        super(id, regNo, eff);
        this.load = load;
        this.gpsId = "TRK-" + id;
    }
    public double estimateCost(Route r) {
        return (r.distanceKm / fuelEfficiency) * r.fuelPrice * (1 + r.congestion * 0.1);
    }
}

// Exception Handling
class InvalidDataException extends Exception {
    public InvalidDataException(String msg) { super(msg); }
}

// Route Model
class Route {
    String src, dst;
    double distanceKm, fuelPrice;
    int congestion;
    public Route(String src, String dst, double d, double f, int c) throws InvalidDataException {
        if (d <= 0) throw new InvalidDataException("Distance must be > 0");
        this.src = src; this.dst = dst; this.distanceKm = d; this.fuelPrice = f; this.congestion = c;
    }
    @Override
    public String toString() { return src + " -> " + dst + " (" + distanceKm + " km)"; }
}

// Multithreading & Synchronization
class TrafficUpdater implements Runnable {
    private final List<Route> routes;
    public TrafficUpdater(List<Route> routes) { this.routes = routes; }

    @Override
    public void run() {
        synchronized (routes) {
            Random r = new Random();
            for (Route rt : routes) {
                rt.congestion = r.nextInt(10);
            }
            System.out.println("Traffic updated by thread " + Thread.currentThread().getName());
        }
    }
}
